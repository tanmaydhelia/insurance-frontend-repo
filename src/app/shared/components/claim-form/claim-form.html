<form [formGroup]="form" (ngSubmit)="submit()" class="space-y-6">
  <div>
    <label for="diagnosis" class="block text-sm font-medium text-gray-700"
      >Diagnosis / Reason</label
    >
    <div class="mt-1">
      <textarea
        id="diagnosis"
        formControlName="diagnosis"
        rows="3"
        class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
        placeholder="e.g. Viral Fever, Fractured Leg..."
      ></textarea>
    </div>
    @if (form.get('diagnosis')?.touched && form.get('diagnosis')?.invalid) {
    <p class="mt-1 text-xs text-red-600">Diagnosis is required.</p>
    }
  </div>

  <div>
    <label for="amount" class="block text-sm font-medium text-gray-700">Claim Amount (₹)</label>
    <div class="mt-1 relative rounded-md shadow-sm">
      <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
        <span class="text-gray-500 sm:text-sm">₹</span>
      </div>
      <input
        type="number"
        id="amount"
        formControlName="claimAmount"
        class="block w-full rounded-md border-gray-300 pl-7 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
        placeholder="0.00"
      />
    </div>
    @if (form.get('claimAmount')?.touched && form.get('claimAmount')?.invalid) {
    <p class="mt-1 text-xs text-red-600">Please enter a valid amount.</p>
    }
  </div>

  <div>
    <label class="block text-sm font-medium text-gray-700">Medical Bills / Reports</label>
    <div
      class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md hover:bg-gray-50 transition-colors"
    >
      <div class="space-y-1 text-center">
        <i class="pi pi-cloud-upload text-gray-400 text-3xl"></i>
        <div class="flex text-sm text-gray-600 justify-center">
          <label
            for="file-upload"
            class="relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none"
          >
            <span>{{ selectedFileName() || 'Upload a file' }}</span>
            <input
              id="file-upload"
              name="file-upload"
              type="file"
              class="sr-only"
              (change)="onFileSelected($event)"
            />
          </label>
        </div>
        <p class="text-xs text-gray-500">PNG, JPG, PDF up to 5MB</p>
      </div>
    </div>
  </div>

  <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
    <button
      type="button"
      (click)="onCancel.emit()"
      class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"
    >
      Cancel
    </button>
    <button
      type="submit"
      [disabled]="form.invalid || isLoading"
      class="inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50"
    >
      @if (isLoading) { <i class="pi pi-spin pi-spinner mr-2"></i> } Submit Claim
    </button>
  </div>
</form>
